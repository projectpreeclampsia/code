import wixData from 'wix-data';
import wixUsers from 'wix-users';
import {session} from 'wix-storage';



const ownerIdToFind = wixUsers.currentUser.id; 
//const ownerIdToFind = "23793226-02f6-49a4-ba68-2e15907ab7a6"; //test user exists

var token = 0; 
wixData.query("contact023")
  .find()
  .then((results) => {
    const items = results.items;
    const itemWithOwnerId = items.find(item => item._owner === ownerIdToFind);
    if (itemWithOwnerId) {
   wixData.query("testEnd").find().then((results) => {
            console.log(results)

    const allResults = results.items;
    const stoppedTest = allResults.find(allResults => allResults._owner === ownerIdToFind);
        console.log(stoppedTest)
            session.setItem("id", stoppedTest._id);
        if (stoppedTest.status == 'Stopped') {
        $w('#form14').show();
	      $w('#text54').hide();
        token = 1; 
        }
        

  });
  if(token == 0){
	  console.log("Found item with ownerId:", ownerIdToFind);
	  $w('#form14').hide();
	  $w('#text54').show();}
	} else {
	  console.log("No item found with ownerId:", ownerIdToFind);
	  $w('#form14').show();
	  $w('#text54').hide();
    }
  })
  .catch((error) => {
    console.log(error);
  });

var token = 0; 
wixData.query("contact024")
  .find()
  .then((results) => {
    const items = results.items;
    const itemWithOwnerId = items.find(item => item._owner === ownerIdToFind);
    if (itemWithOwnerId) {
   wixData.query("testEnd").find().then((results) => {
            console.log(results)

    const allResults = results.items;
    const stoppedTest = allResults.find(allResults => allResults._owner === ownerIdToFind);
        console.log(stoppedTest)
            session.setItem("id", stoppedTest._id);
        if (stoppedTest.status == 'Stopped') {
        $w('#form15').show();
	      $w('#text54').hide();
        token = 1; 
        }
        

  });
  if(token == 0){
	  console.log("Found item with ownerId:", ownerIdToFind);
	  $w('#form15').hide();
	  $w('#text54').show();}
	} else {
	  console.log("No item found with ownerId:", ownerIdToFind);
	  $w('#form15').show();
	  $w('#text54').hide();
    }
  })
  .catch((error) => {
    console.log(error);
  });
  
$w.onReady(function () {
  // Get references to the relevant input elements
  const question1Input1 = $w("#radioGroup12");
  const question1Input2 = $w("#radioGroup10");

  const conditionalField11 = $w("#input2");
  const conditionalField22 = $w("#input3");

  // Hide the conditional fields initially
  conditionalField11.hide();
  conditionalField22.hide();

  // Add an event handler for the input change event
  question1Input1.onChange(() => {
    // Check the value of the question1Input field
    if (question1Input1.value === "yes") {
      // Show the conditional fields if the condition is met
      conditionalField11.show();
    } else {
      // Hide the conditional fields if the condition is not met
      conditionalField11.hide();
    }
  }

  );

  // Add an event handler for the input change event
  question1Input2.onChange(() => {
    // Check the value of the question1Input field
    if (question1Input2.value === "yes") {
      // Show the conditional fields if the condition is met
      conditionalField22.show();
    } else {
      // Hide the conditional fields if the condition is not met
      conditionalField22.hide();
    }
  }

  );
});
